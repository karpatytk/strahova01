<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–°—Ç—Ä–∞—Ö—É–≤–∞–Ω–Ω—è 360 ‚Äî –ß–∞—Ç –∑ –Ñ–≤–æ—é</title>
  <style>
    body { font-family: Arial; background: #f5f5f5; display: flex; justify-content: center; padding: 50px; }
    .chat-box { max-width: 380px; width: 100%; border-radius: 20px; border: 1px solid #ccc; padding: 20px; background: #fff; box-shadow: 0 0 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
    .chat-message { margin-bottom: 12px; line-height: 1.4; }
    .eva { background: #f0f0f0; padding: 10px 14px; border-radius: 12px; display: inline-block; }
    .user { background: #d0f1d0; padding: 10px 14px; border-radius: 12px; display: inline-block; align-self: flex-end; }
    .chat-input { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #aaa; margin-top: 10px; }
    #sendBtn { width: 100%; padding: 10px; border: none; border-radius: 10px; background: #4CAF50; color: white; font-size: 16px; margin-top: 6px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="chat-box">
    <div id="chatArea">
      <div class="chat-message eva">
        –ü—Ä–∏–≤—ñ—Ç! –Ø –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ñ–≤–∞ üòä<br>–Ø –¥–æ–ø–æ–º–æ–∂—É –≤–∞–º –æ—Ñ–æ—Ä–º–∏—Ç–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∫—É.<br>–Ø–∫ –≤–∞—Å –∑–≤–∞—Ç–∏?
      </div>
    </div>
    <input id="chatInput" class="chat-input" placeholder="–í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å..." />
    <button id="sendBtn">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
  </div>

  <script>
    let step = 0;
    let userData = { name: "", type: "", phone: "" };

    const sendBtn = document.getElementById("sendBtn");
    const chatInput = document.getElementById("chatInput");

    sendBtn.onclick = sendMessage;

    function addMessage(text, sender) {
      let div = document.createElement("div");
      div.className = "chat-message " + sender;
      div.innerHTML = text;
      document.getElementById("chatArea").appendChild(div);
      div.scrollIntoView({behavior: "smooth"});
    }

    function sendMessage() {
      let text = chatInput.value.trim();
      if (!text) return;

      addMessage(text, "user");
      chatInput.value = "";

      if (step === 0) {
        userData.name = text;
        setTimeout(() => addMessage("–ü—Ä–∏—î–º–Ω–æ –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å, " + text + "! üòä<br>–Ø–∫–∏–π –≤–∏–¥ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –≤–∞—Å —Ü—ñ–∫–∞–≤–∏—Ç—å?", "eva"), 500);
        step = 1;
      } else if (step === 1) {
        userData.type = text;
        setTimeout(() => addMessage("–°—É–ø–µ—Ä! –¢–µ–ø–µ—Ä, –±—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ª–∏—à—Ç–µ —Å–≤—ñ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É üìû", "eva"), 500);
        step = 2;
      } else if (step === 2) {
        userData.phone = text;
        chatInput.disabled = true;
        sendBtn.disabled = true;
        setTimeout(() => addMessage("–î—è–∫—É—é! –í—ñ–¥–ø—Ä–∞–≤–ª—è—é –≤–∞—à—ñ –¥–∞–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É‚Ä¶ ‚è≥", "eva"), 500);
        sendToServer();
        step = 3;
      }
    }

    function sendToServer() {
      fetch("/api/sendTelegram", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(userData)
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          addMessage("–ì–æ—Ç–æ–≤–æ! –Ø –ø–µ—Ä–µ–¥–∞–ª–∞ –∑–∞—è–≤–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä—É. –í–∞–º –∑–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É—é—Ç—å –Ω–∞–π–±–ª–∏–∂—á–∏–º —á–∞—Å–æ–º üôå", "eva");
        } else {
          addMessage("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.", "eva");
        }
      })
      .catch(() => addMessage("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.", "eva"));
    }
  </script>
</body>
</html>
